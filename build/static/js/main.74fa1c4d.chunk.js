(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{12:function(t,e,n){"use strict";n.d(e,"a",(function(){return r.a})),n.d(e,"c",(function(){return a.a})),n.d(e,"b",(function(){return u}));var c,r=n(18),a=n(29),o=n(5),i=n(3),u=Object(i.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1,isLoading:!1},extraReducers:(c={},Object(o.a)(c,r.a.register.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(o.a)(c,r.a.logIn.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(o.a)(c,r.a.logOut.fulfilled,(function(t){t.user={name:null,email:null},t.token=null,t.isLoggedIn=!1})),Object(o.a)(c,r.a.fetchCurrentUser.pending,(function(t){t.isLoading=!0})),Object(o.a)(c,r.a.fetchCurrentUser.fulfilled,(function(t,e){t.user=e.payload,t.isLoggedIn=!0,t.isLoading=!1})),Object(o.a)(c,r.a.fetchCurrentUser.rejected,(function(t){t.isLoading=!1})),c)}).reducer},18:function(t,e,n){"use strict";var c=n(15),r=n.n(c),a=n(20),o=n(16),i=n.n(o),u=n(3);i.a.defaults.baseURL="https://connections-api.herokuapp.com";var s=function(t){i.a.defaults.headers.common.Authorization="Bearer ".concat(t)},l=function(){i.a.defaults.headers.common.Authorization=""},b=Object(u.c)("auth/register",function(){var t=Object(a.a)(r.a.mark((function t(e){var n,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.a.post("/users/signup",e);case 3:return n=t.sent,c=n.data,s(c.token),t.abrupt("return",c);case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),d=Object(u.c)("auth/login",function(){var t=Object(a.a)(r.a.mark((function t(e){var n,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.a.post("/users/login",e);case 3:return n=t.sent,c=n.data,s(c.token),t.abrupt("return",c);case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),j=Object(u.c)("auth/logout",Object(a.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.a.post("/users/logout");case 3:l(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))),f=Object(u.c)("auth/refresh",function(){var t=Object(a.a)(r.a.mark((function t(e,n){var c,a,o,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=n.getState(),null!==(a=c.auth.token)){t.next=4;break}return t.abrupt("return",n.rejectWithValue());case 4:return s(a),t.prev=5,t.next=8,i.a.get("users/current");case 8:return o=t.sent,u=o.data,t.abrupt("return",u);case 13:t.prev=13,t.t0=t.catch(5),console.error(t.t0);case 16:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e,n){return t.apply(this,arguments)}}()),O={register:b,logOut:j,logIn:d,fetchCurrentUser:f};e.a=O},29:function(t,e,n){"use strict";var c={getIsLoggedIn:function(t){return t.auth.isLoggedIn},getUsername:function(t){return t.auth.user.name},getIsLoading:function(t){return t.auth.isLoading}};e.a=c},35:function(t,e,n){"use strict";var c=n(15),r=n.n(c),a=n(20),o=n(16),i=n.n(o),u=n(4);e.a={addContacts:function(t,e){return function(n){var c={name:t,number:e};n(Object(u.b)()),i.a.post("/contacts",c).then((function(t){var e=t.data;return n(Object(u.c)(e))})).catch((function(t){return n(Object(u.a)(t))}))}},deleteContacts:function(t){return function(e){e(Object(u.e)()),i.a.delete("/contacts/".concat(t)).then((function(){return e(Object(u.f)(t))})).catch((function(t){return e(Object(u.d)(t))}))}},fetchContacts:function(){return function(){var t=Object(a.a)(r.a.mark((function t(e){var n,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(Object(u.h)()),t.prev=1,t.next=4,i.a.get("/contacts");case 4:n=t.sent,c=n.data,e(Object(u.i)(c)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),e(Object(u.g)(t.t0.message));case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}}},37:function(t,e,n){"use strict";var c=n(23),r=function(t){return t.contacts.filter},a=Object(c.a)([function(t){return t.contacts.items},r],(function(t,e){var n=e.toLowerCase();return t.filter((function(t){return t.name.toLowerCase().includes(n)}))}));e.a={getFilter:r,getFilteredContacts:a}},4:function(t,e,n){"use strict";n.d(e,"h",(function(){return r})),n.d(e,"i",(function(){return a})),n.d(e,"g",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return s})),n.d(e,"e",(function(){return l})),n.d(e,"f",(function(){return b})),n.d(e,"d",(function(){return d})),n.d(e,"j",(function(){return j}));var c=n(3),r=Object(c.b)("contacts/fetchContactsRequest"),a=Object(c.b)("contacts/fetchContactsSuccess"),o=Object(c.b)("contacts/fetchContactsError"),i=Object(c.b)("contacts/addContactsRequest"),u=Object(c.b)("contacts/addContactsSuccess"),s=Object(c.b)("contacts/addContactsError"),l=Object(c.b)("contacts/deleteContactsRequest"),b=Object(c.b)("contacts/deleteContactsSuccess"),d=Object(c.b)("contacts/deleteContactsError"),j=Object(c.b)("contacts/filter")},50:function(t,e,n){t.exports={button:"userMenu_button__2Vj7N"}},60:function(t,e,n){},85:function(t,e,n){},86:function(t,e,n){"use strict";n.r(e);var c=n(0),r=n.n(c),a=n(28),o=n.n(a),i=n(17),u=n(7),s=n(48),l=n(6),b=(n(60),n(1)),d=function(t){var e=t.children;return Object(b.jsx)("div",{className:"Container",children:e})},j=function(t){var e=t.children;return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(d,{children:e})})},f=n(12),O={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,fontSize:24,color:"#2A363B"},activeLink:{color:"#E84A5F"}},h=function(){var t=Object(u.d)(f.c.getIsLoggedIn);return Object(b.jsxs)("nav",{children:[Object(b.jsx)(i.b,{to:"/",exact:!0,style:O.link,activeStyle:O.activeLink,children:"Home"}),t&&Object(b.jsx)(i.b,{to:"/contacts",exact:!0,style:O.link,activeStyle:O.activeLink,children:"Contacts"})]})},g=n(18),p=n(29),v=n(50),x=n.n(v),k={container:{display:"flex",alignItems:"center",fontSize:24},avatar:{marginRight:4},name:{fontWeight:700,marginRight:12}};function m(){var t=Object(u.c)(),e=Object(u.d)(p.a.getUsername);return Object(b.jsxs)("div",{style:k.container,children:[Object(b.jsxs)("span",{style:k.name,children:["Welcome,",e]}),Object(b.jsx)("button",{type:"button",className:x.a.button,onClick:function(){return t(g.a.logOut())},children:"Logout"})]})}var y={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,fontSize:24,color:"#2A363B"},activeLink:{color:"#E84A5F"}};function L(){return Object(b.jsxs)("div",{children:[Object(b.jsx)(i.b,{to:"/register",exact:!0,style:y.link,activeStyle:y.activeLink,children:"Registration"}),Object(b.jsx)(i.b,{to:"/login",exact:!0,style:y.link,activeStyle:y.activeLink,children:"Login"})]})}var C={header:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #2A363B"}};function I(){var t=Object(u.d)(f.c.getIsLoggedIn);return Object(b.jsxs)("header",{style:C.header,children:[Object(b.jsx)(h,{}),t?Object(b.jsx)(m,{}):Object(b.jsx)(L,{})]})}var w=n(22),S=n(31),z=["children"];function A(t){var e=t.children,n=Object(S.a)(t,z),c=Object(u.d)(f.c.getIsLoggedIn);return Object(b.jsx)(l.b,Object(w.a)(Object(w.a)({},n),{},{children:c?e:Object(b.jsx)(l.a,{to:"/login/"})}))}var R=["children","restricted"];function U(t){var e=t.children,n=t.restricted,c=void 0!==n&&n,r=Object(S.a)(t,R),a=Object(u.d)(f.c.getIsLoggedIn)&&c;return console.log(a),Object(b.jsx)(l.b,Object(w.a)(Object(w.a)({},r),{},{children:a?Object(b.jsx)(l.a,{to:"/"}):e}))}var E=Object(c.lazy)((function(){return n.e(6).then(n.bind(null,93))})),B=Object(c.lazy)((function(){return n.e(5).then(n.bind(null,94))})),F=Object(c.lazy)((function(){return n.e(4).then(n.bind(null,95))})),W=Object(c.lazy)((function(){return n.e(3).then(n.bind(null,96))}));function q(){var t=Object(u.c)(),e=Object(u.d)(f.c.getIsLoading);return console.log(e),Object(c.useEffect)((function(){t(f.a.fetchCurrentUser())}),[t]),!e&&Object(b.jsxs)(j,{children:[Object(b.jsx)(I,{}),Object(b.jsx)(l.d,{children:Object(b.jsxs)(c.Suspense,{fallback:Object(b.jsx)("div",{children:"Loading..."}),children:[Object(b.jsx)(U,{exact:!0,path:"/",children:Object(b.jsx)(E,{})}),Object(b.jsx)(U,{path:"/register",children:Object(b.jsx)(B,{})}),Object(b.jsx)(U,{exact:!0,path:"/login",restricted:!0,children:Object(b.jsx)(F,{})}),Object(b.jsx)(A,{path:"/contacts",restricted:!0,children:Object(b.jsx)(W,{})})]})})]})}var N,_,D=n(30),J=n(3),M=n(19),V=n(51),H=n.n(V),T=(n(35),n(37),n(4)),G=n(5),K=n(8),P=Object(J.d)([],(N={},Object(G.a)(N,T.i,(function(t,e){return e.payload})),Object(G.a)(N,T.c,(function(t,e){return[].concat(Object(D.a)(t),[e.payload])})),Object(G.a)(N,T.f,(function(t,e){return t.filter((function(t){return t.id!==e.payload}))})),N)),Q=Object(J.d)(!1,(_={},Object(G.a)(_,T.h,(function(){return!0})),Object(G.a)(_,T.i,(function(){return!1})),Object(G.a)(_,T.g,(function(){return!1})),Object(G.a)(_,T.b,(function(){return!0})),Object(G.a)(_,T.c,(function(){return!1})),Object(G.a)(_,T.a,(function(){return!1})),Object(G.a)(_,T.e,(function(){return!0})),Object(G.a)(_,T.f,(function(){return!1})),Object(G.a)(_,T.d,(function(){return!1})),_)),X=Object(J.d)("",Object(G.a)({},T.j,(function(t,e){return e.payload}))),Y=Object(K.b)({items:P,filter:X,loading:Q}),Z=Object(D.a)(Object(J.f)({serializableCheck:{ignoredActions:[M.a,M.f,M.b,M.c,M.d,M.e]}})),$={key:"auth",storage:H.a,whitelist:["token"]},tt=Object(J.a)({reducer:{auth:Object(M.g)($,f.b),contacts:Y},middleware:Z,devTools:!1}),et=Object(M.h)(tt);n(85);o.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(u.a,{store:tt,children:Object(b.jsx)(s.a,{loading:null,persistor:et,children:Object(b.jsx)(i.a,{children:Object(b.jsx)(q,{})})})})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.74fa1c4d.chunk.js.map